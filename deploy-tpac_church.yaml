apiVersion: 2021-10-01
location: eastasia
name: tpacChurchAppGroup
properties:
  containers:
  - name: tpac-churchapp-api
    properties:
      image: tpacacr.azurecr.io/tpac_api:latest
      resources:
        requests:
          cpu: 1
          memoryInGb: 1.5
      ports:
      - port: 80
  - name: tpac-churchapp-admin
    properties:
      image: tpacacr.azurecr.io/tpac_admin:latest
      resources:
        requests:
          cpu: 1
          memoryInGb: 1.5
      ports:
      - port: 8080
  - name: tpac-churchapp-db
    properties:
      image: tpacacr.azurecr.io/tpac_db:latest
      resources:
        requests:
          cpu: 1
          memoryInGb: 1.5
      ports:
      - port: 3306
      environmentVariables:
        - name: MYSQL_ROOT_PASSWORD
          value: rootpassword
      volumeMounts:
      - mountPath: /var/lib/mysql
        name: fileshare
  osType: Linux
  ipAddress:
    type: Public
    ports:
    - protocol: tcp
      port: 80
    - protocol: tcp
      port: 8080
    - protocol: tcp
      port: 3306
  volumes:
  - name: fileshare
    azureFile:
      sharename: tpacfileshare
      storageAccountName: tpacstorageaccount
      storageAccountKey: Ai84yRYLRiOt4vYeuQvKpo9fCm8F29xP/TcmhYX1U056Gl1Z/C52uTx5D89HmwlyWglOn2g/x+Tf+AStuPue/A==
  imageRegistryCredentials:
  - server: tpacacr.azurecr.io
    username: 07434292-f76a-42a7-8c3d-0f1bab89f3c6
    password: Xgh8Q~sMnf5rDjU8uA6T3Bv3tC~dpD1yPqNBlddW
tags: {tpacchurch: churchapp}
type: Microsoft.ContainerInstance/containerGroups
